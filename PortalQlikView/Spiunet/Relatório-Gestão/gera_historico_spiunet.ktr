<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>gera_historico_spiunet</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
      <parameter>
        <name>OLTP</name>
        <default_value>10.209.9.227</default_value>
        <description/>
      </parameter>
      <parameter>
        <name>SERVIDOR</name>
        <default_value>10.209.9.227</default_value>
        <description/>
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2016/04/25 17:30:31.206</created_date>
    <modified_user>-</modified_user>
    <modified_date>2016/04/25 17:30:31.206</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>bispu</name>
    <server>${SERVIDOR}</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>bispu</database>
    <port>5432</port>
    <username>bispu</username>
    <password>Encrypted 2be98afc86aa7f2e4aa2fa060d3c6a69b</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>5432</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>oltp</name>
    <server>${OLTP}</server>
    <type>POSTGRESQL</type>
    <access>Native</access>
    <database>oltp</database>
    <port>5432</port>
    <username>oltp</username>
    <password>Encrypted 2be98afc86aa7f2e4aa2fa060d3c6a69b</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>5432</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Seleciona SPIUnet</from>
      <to>Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values</from>
      <to>Table output</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>Seleciona SPIUnet</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>oltp</connection>
    <sql>select distinct 
       -- Dados do Imóvel
       i.imv_sg_uf, i.imv_co_municipio, m.no_municipio, i.imv_nu_rip, i.imv_ed_tipologradouro, i.imv_ed_logradouro, i.imv_ed_numero, 
       i.imv_ed_complemento, i.imv_ed_bairro, i.imv_ed_cep,

       -- Dados do Terreno
       i.imv_co_conceituacaoterreno, ct.no_conceituacaoterreno, i.imv_co_naturezaterreno, nt.no_naturezaterreno, i.imv_mq_areaterreno,
       i.imv_va_metroquadrado, i.imv_op_fracaoideal, i.imv_va_terreno as imv_va_terreno_imovel,

       -- Dados da Benfeitoria
       b.bnf_mq_areaconstruida, b.bnf_op_fatorkp, b.bnf_qt_pavimento,

       -- Dados do Imóvel
       i.imv_da_cadastro, ti.co_tipoimovel, ti.no_tipoimovel, i.imv_op_fatorcorretivo, i.imv_va_somabenfeitoriautilizacao,
       i.imv_va_imovel, i.imv_da_avaliacao, i.imv_co_tipovocacao, tv.no_tipovocacao,-- nri.no_nivelrigoravaliacao as no_nivelrigoravaliacaoimovel,-- mci.no_motivocancelamentoimovel,

       -- Dados Complementares 
       i.imv_co_formaaquisicao, fa.no_formaaquisicao,  po.co_proprietariooficial, po.no_proprietariooficial,
       i.imv_no_fundamentoincorporacao, imv_no_situacaoincorporacao, i.imv_da_incorporacao, imv_no_proprietarioanterior,
       case when i.imv_co_orgaoextinto is null then 0 else i.imv_co_orgaoextinto end imv_co_orgaoextinto,
       case when i.imv_co_orgaoextinto is null then 'Sem Informação' else oex.no_orgaoextinto end no_orgaoextinto,
       oex.sg_orgaoextinto,

       -- Dados Cartório
       i.imv_no_cartoriooficio, i.imv_nu_matriculacartorio, i.imv_nu_livrocartorio, i.imv_nu_folhacartorio, imv_da_registrocartorio,

       -- Dados da Utilização
       coalesce(u.uti_nu_rip,-1) uti_nu_rip, ev.eve_da_evento as data_cadastramento_utilizacao, 
       coalesce(u.uti_co_ug, 0) uti_co_ug, 
       coalesce(ug.no_ug, 'Sem Informação') no_ug, 
       u.uti_ed_tipologradouro_corr, 
       u.uti_ed_logradouro_corr, u.uti_ed_numero_corr, u.uti_ed_complemento_corr,  
       
       case when u.uti_co_regime in (2,22) then u.uti_va_beneficio else 0.00 end vl_aluguel,
	   u.uti_no_beneficiario, u.uti_nu_cpfcnpjbeneficiario, u.uti_no_encargocessao, u.uti_no_objetivocessao, u.uti_nu_processo, 

       -- Dados do Terreno da Utilização
       u.uti_mq_areaterreno, u.uti_op_fracaoideal, u.uti_va_metroquadrado, u.uti_va_terreno,
       
       -- Benfeitoria da Utilização
       b.bnf_mq_areaconstruida as bnf_mq_areaconstruida_dadosbenfeitoria, b.bnf_op_cub, b.bnf_va_benfeitoria,
       b.bnf_co_estadoconservacao, ec.no_estadoconservacao, b.bnf_co_tipoestrutura, te.no_tipoestrutura as no_tipoestrutura_dadosbenfeitoria,
       ia.no_idadeaparente, b.bnf_op_fatorkp as bnf_op_fatorkp_dadosbenfeitoria, pa.no_padraoacabamento, 
       b.bnf_qt_pavimento as bnf_qt_pavimento_dadosbenfeitoria, b.bnf_co_uso, ui.no_usoimovel, 
       
       -- Avaliação do Imóvel 
	   case when u.uti_co_regime is not null then u.uti_co_tipodestinacao else '-1' end uti_co_tipodestinacao, 
       case when u.uti_co_regime is not null then td.no_tipodestinacao else 'SI' end no_tipodestinacao, 
       u.uti_no_vocacao, u.uti_op_fatorcorretivo,
       u.uti_va_utilizacao, u.uti_da_avaliacao, u.uti_da_prazovalidadeavaliacao,
       case when u.uti_co_regime is not null then nr.co_nivelrigoravaliacao else '-1' end uti_co_nivelrigoravaliacao, 
       case when u.uti_co_regime is not null then nr.no_nivelrigoravaliacao else 'SI' end no_nivelrigoravaliacao,	  

       -- Regime da Utilização
       case when u.uti_co_regime is not null then u.uti_co_regime else '00' end uti_co_regime, 
       case when u.uti_co_regime is not null then ru.no_regimeutilizacao else 'AGUARDANDO DESTINAÇÃO' end no_regimeutilizacao, 
       u.uti_da_inicio, u.uti_da_fim,  td.co_classificacaosiafi as cod_destinacao_siafi, i.imv_nu_processoprincipal nu_processoprincipal,
       '2020'::varchar(4) nu_ano, '12'::varchar(2) nu_mes
  from spiunet.imovel i
       left join spiunet.municipio m on m.co_municipio = i.imv_co_municipio
       left join spiunet.conceituacaoterreno ct on ct.co_conceituacaoterreno = i.imv_co_conceituacaoterreno
       left join spiunet.naturezaterreno nt on nt.co_naturezaterreno = i.imv_co_naturezaterreno
       left join spiunet.tipoimovel ti on ti.co_tipoimovel = i.imv_co_tipoimovel
       left join spiunet.tipovocacao tv on tv.co_tipovocacao = i.imv_co_tipovocacao
       left join spiunet.formaaquisicao fa on fa.co_formaaquisicao = i.imv_co_formaaquisicao
       left join spiunet.orgaoextinto oex on oex.co_orgaoextinto = i.imv_co_orgaoextinto
	   --left join spiunet.nivelrigoravaliacao nri on nri.co_nivelrigoravaliacao = i.imv_co_nivelrigoravaliacao
	   --left join spiunet.motivocancelamentoimovel mci on mci.co_motivocancelamentoimovel = i.imv_co_motivocancelamentoimovel
       inner join spiunet.proprietariooficial po on po.co_proprietariooficial = i.imv_co_proprietariooficial 
       left join spiunet.utilizacao u
                 left join  spiunet.evento ev on ev.eve_nu_rip_utilizacao = u.uti_nu_rip and eve_co_tipo = '7' --Cadastramento de Utilizacao
                 left join  spiunet.nivelrigoravaliacao nr on nr.co_nivelrigoravaliacao = u.uti_co_nivelrigoravaliacao
                 left join  spiunet.tipodestinacao td on td.co_tipodestinacao = u.uti_co_tipodestinacao
                 left join  spiunet.regimeutilizacao ru on ru.co_regimeutilizacao = u.uti_co_regime
                 left join  spiunet.v_ug ug                 
                 on ug.co_ug = u.uti_co_ug and u.uti_co_gestao = ug.co_gestaoprincipal
                 left join spiunet.benfeitoria b 
                           left join spiunet.tipoestrutura te on te.co_tipoestrutura = b.bnf_co_tipoestrutura
                           left join spiunet.estadoconservacao ec on ec.co_estadoconservacao = b.bnf_co_estadoconservacao
                           left join spiunet.idadeaparente ia on ia.co_idadeaparente = b.bnf_co_idadeaparente
                           left join spiunet.padraoacabamento pa on pa.co_padraoacabamento = bnf_co_padraoacabamento
                           left join spiunet.usoimovel ui on ui.co_usoimovel = b.bnf_co_uso
                 on b.bnf_nu_rip_imovel = u.uti_nu_rip_imovel and b.bnf_nu_rip_utilizacao = u.uti_nu_rip           
        on u.uti_nu_rip_imovel = i.imv_nu_rip and u.uti_co_motivocancelamentoutilizacao = '101' --ativas
 </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>96</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>imv_sg_uf</name>
        <rename>sg_uf</rename>
      </field>
      <field>
        <name>imv_co_municipio</name>
        <rename>co_municipio</rename>
      </field>
      <field>
        <name>no_municipio</name>
      </field>
      <field>
        <name>imv_nu_rip</name>
        <rename>nu_rip_imovel</rename>
      </field>
      <field>
        <name>imv_ed_tipologradouro</name>
        <rename>ed_tipologradouro_imovel</rename>
      </field>
      <field>
        <name>imv_ed_logradouro</name>
        <rename>ed_logradouro_imovel</rename>
      </field>
      <field>
        <name>imv_ed_numero</name>
        <rename>ed_numero_imovel</rename>
      </field>
      <field>
        <name>imv_ed_complemento</name>
        <rename>ed_complemento_imovel</rename>
      </field>
      <field>
        <name>imv_ed_bairro</name>
        <rename>ed_bairro_imovel</rename>
      </field>
      <field>
        <name>imv_ed_cep</name>
        <rename>ed_cep_imovel</rename>
      </field>
      <field>
        <name>imv_co_conceituacaoterreno</name>
        <rename>co_conceituacaoterreno</rename>
      </field>
      <field>
        <name>no_conceituacaoterreno</name>
      </field>
      <field>
        <name>imv_co_naturezaterreno</name>
        <rename>co_naturezaterreno</rename>
      </field>
      <field>
        <name>no_naturezaterreno</name>
      </field>
      <field>
        <name>imv_mq_areaterreno</name>
        <rename>mq_areaterreno_imovel</rename>
      </field>
      <field>
        <name>imv_va_metroquadrado</name>
        <rename>vl_metroquadrado_terreno</rename>
      </field>
      <field>
        <name>imv_op_fracaoideal</name>
        <rename>op_fracao_ideal</rename>
      </field>
      <field>
        <name>imv_va_terreno_imovel</name>
        <rename>vl_terreno_imovel</rename>
      </field>
      <field>
        <name>bnf_mq_areaconstruida</name>
        <rename>mq_areaconstruida</rename>
      </field>
      <field>
        <name>bnf_op_fatorkp</name>
        <rename>op_fatorkp</rename>
      </field>
      <field>
        <name>bnf_qt_pavimento</name>
        <rename>qt_pavimentos</rename>
      </field>
      <field>
        <name>imv_da_cadastro</name>
        <rename>dt_cadastro_imovel</rename>
      </field>
      <field>
        <name>co_tipoimovel</name>
      </field>
      <field>
        <name>no_tipoimovel</name>
      </field>
      <field>
        <name>imv_op_fatorcorretivo</name>
        <rename>op_fatorcorretivo_imovel</rename>
      </field>
      <field>
        <name>imv_va_somabenfeitoriautilizacao</name>
        <rename>vl_somabenfeitoria</rename>
      </field>
      <field>
        <name>imv_va_imovel</name>
        <rename>vl_imovel</rename>
      </field>
      <field>
        <name>imv_da_avaliacao</name>
        <rename>dt_avaliacao_imovel</rename>
      </field>
      <field>
        <name>imv_co_tipovocacao</name>
        <rename>co_tipovocacao</rename>
      </field>
      <field>
        <name>no_tipovocacao</name>
      </field>
      <field>
        <name>imv_co_formaaquisicao</name>
        <rename>co_formaaquisicao</rename>
      </field>
      <field>
        <name>no_formaaquisicao</name>
      </field>
      <field>
        <name>imv_no_proprietarioanterior</name>
        <rename>no_proprietarioanterior</rename>
      </field>
      <field>
        <name>imv_no_fundamentoincorporacao</name>
        <rename>no_fundamentoincorporacao</rename>
      </field>
      <field>
        <name>imv_no_situacaoincorporacao</name>
        <rename>no_situacaoincorporacao</rename>
      </field>
      <field>
        <name>imv_da_incorporacao</name>
        <rename>dt_incorporacao</rename>
      </field>
      <field>
        <name>uti_nu_rip</name>
        <rename>nu_rip_utilizacao</rename>
      </field>
      <field>
        <name>data_cadastramento_utilizacao</name>
        <rename>dt_cadastro_utilizacao</rename>
      </field>
      <field>
        <name>uti_co_ug</name>
        <rename>co_ug</rename>
      </field>
      <field>
        <name>no_ug</name>
      </field>
      <field>
        <name>uti_ed_tipologradouro_corr</name>
        <rename>ed_tipologradouro_correspondencia</rename>
      </field>
      <field>
        <name>uti_ed_logradouro_corr</name>
        <rename>ed_logradouro_correspondencia</rename>
      </field>
      <field>
        <name>uti_ed_numero_corr</name>
        <rename>ed_numero_correspondencia</rename>
      </field>
      <field>
        <name>uti_ed_complemento_corr</name>
        <rename>ed_complemento_correspondencia</rename>
      </field>
      <field>
        <name>uti_mq_areaterreno</name>
        <rename>mq_areaterreno_utilizacao</rename>
      </field>
      <field>
        <name>uti_op_fracaoideal</name>
        <rename>op_fracaoideal</rename>
      </field>
      <field>
        <name>uti_va_metroquadrado</name>
        <rename>vl_metroquadrado_utilizacao</rename>
      </field>
      <field>
        <name>uti_va_terreno</name>
        <rename>vl_terreno_utilizacao</rename>
      </field>
      <field>
        <name>bnf_mq_areaconstruida_dadosbenfeitoria</name>
        <rename>mq_areaconstruida_benfeitoria</rename>
      </field>
      <field>
        <name>bnf_op_cub</name>
        <rename>op_cub</rename>
      </field>
      <field>
        <name>bnf_va_benfeitoria</name>
        <rename>vl_benfeitoria</rename>
      </field>
      <field>
        <name>bnf_co_estadoconservacao</name>
        <rename>co_estadoconservacao</rename>
      </field>
      <field>
        <name>no_estadoconservacao</name>
      </field>
      <field>
        <name>bnf_co_tipoestrutura</name>
        <rename>co_tipoestrutura</rename>
      </field>
      <field>
        <name>no_tipoestrutura_dadosbenfeitoria</name>
        <rename>no_tipoestrutura</rename>
      </field>
      <field>
        <name>no_idadeaparente</name>
      </field>
      <field>
        <name>no_padraoacabamento</name>
      </field>
      <field>
        <name>bnf_qt_pavimento_dadosbenfeitoria</name>
        <rename>qt_pavimentos_benfeitoria</rename>
      </field>
      <field>
        <name>bnf_co_uso</name>
        <rename>co_usoimovel</rename>
      </field>
      <field>
        <name>no_usoimovel</name>
      </field>
      <field>
        <name>uti_co_tipodestinacao</name>
        <rename>co_tipodestinacao</rename>
      </field>
      <field>
        <name>no_tipodestinacao</name>
      </field>
      <field>
        <name>uti_no_vocacao</name>
        <rename>no_vocacao</rename>
      </field>
      <field>
        <name>uti_op_fatorcorretivo</name>
        <rename>op_fatorcorretivo_utilizacao</rename>
      </field>
      <field>
        <name>uti_co_nivelrigoravaliacao</name>
        <rename>co_nivelrigoravaliacao</rename>
      </field>
      <field>
        <name>no_nivelrigoravaliacao</name>
      </field>
      <field>
        <name>uti_va_utilizacao</name>
        <rename>vl_utilizacao</rename>
      </field>
      <field>
        <name>uti_da_avaliacao</name>
        <rename>dt_avaliacao_utilizacao</rename>
      </field>
      <field>
        <name>uti_da_prazovalidadeavaliacao</name>
        <rename>dt_prazovalidadeavaliacao</rename>
      </field>
      <field>
        <name>uti_co_regime</name>
        <rename>co_regime</rename>
      </field>
      <field>
        <name>no_regimeutilizacao</name>
        <rename>no_regime</rename>
      </field>
      <field>
        <name>uti_da_inicio</name>
        <rename>dt_inicio_utilizacao</rename>
      </field>
      <field>
        <name>uti_da_fim</name>
        <rename>dt_fim_utilizacao</rename>
      </field>
      <field>
        <name>cod_destinacao_siafi</name>
        <rename>co_destinacao_siafi</rename>
      </field>
      <field>
        <name>bnf_co_estadoconservacao</name>
      </field>
      <field>
        <name>co_proprietariooficial</name>
      </field>
      <field>
        <name>no_proprietariooficial</name>
      </field>
      <field>
        <name>imv_no_situacaoincorporacao</name>
        <rename>no_situacao_incorporacao</rename>
      </field>
      <field>
        <name>imv_co_orgaoextinto</name>
      </field>
      <field>
        <name>no_orgaoextinto</name>
      </field>
      <field>
        <name>sg_orgaoextinto</name>
      </field>
      <field>
        <name>vl_aluguel</name>
      </field>
      <field>
        <name>imv_no_cartoriooficio</name>
      </field>
      <field>
        <name>imv_nu_matriculacartorio</name>
      </field>
      <field>
        <name>imv_nu_livrocartorio</name>
      </field>
      <field>
        <name>imv_nu_folhacartorio</name>
      </field>
      <field>
        <name>imv_da_registrocartorio</name>
      </field>
      <field>
        <name>uti_no_beneficiario</name>
      </field>
      <field>
        <name>uti_nu_cpfcnpjbeneficiario</name>
      </field>
      <field>
        <name>uti_no_encargocessao</name>
      </field>
      <field>
        <name>uti_no_objetivocessao</name>
      </field>
      <field>
        <name>uti_nu_processo</name>
      </field>
      <field>
        <name>nu_processoprincipal</name>
      </field>
      <field>
        <name>nu_ano</name>
      </field>
      <field>
        <name>nu_mes</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>272</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table output</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>bispu</connection>
    <schema>dw_spiunet</schema>
    <table>ods_spiunet_historico</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>N</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>448</xloc>
      <yloc>48</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
